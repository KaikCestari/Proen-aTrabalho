<section class="products">
  <header class="products__header">
    <div class="products__intro">
      <h1>Produtos em Destaque</h1>
      <p>Explore nossas ofertas exclusivas e encontre os melhores produtos para você.</p>
    </div>
  </header>
  <div class="products__layout">
    <div class="products__catalog">
      <p class="products__empty" *ngIf="filteredCategories.length === 0 && currentQuery">
        Nenhum produto encontrado para "{{ currentQuery }}".
      </p>
      <article *ngFor="let category of filteredCategories; trackBy: trackByCategory">
        <header>
          <h2>{{ category.name }}</h2>
          <p>{{ category.description }}</p>
        </header>
        <div class="products__items">
          <article class="product-card" *ngFor="let item of category.items; trackBy: trackByItem">
            <figure class="product-card__media">
              <img [src]="item.imageUrl" [alt]="item.name" loading="lazy" />
            </figure>
            <div class="product-card__body">
              <div class="product-card__topline">
                <strong class="product-card__price">
                  {{ item.price | currency: 'BRL':'symbol-narrow' }}
                </strong>
                <span class="product-card__installments">
                  em até 3x de {{ (item.price / 3) | currency: 'BRL':'symbol-narrow' }} sem juros
                </span>
                <span class="product-card__shipping">Frete grátis Proença+</span>
              </div>
              <h3 class="product-card__title">{{ item.name }}</h3>
              <p class="product-card__description">{{ item.description }}</p>
              <span class="product-card__location">Retire hoje na loja Proença (Centro)</span>
            </div>
            <div class="product-card__actions">
              <button type="button" class="product-card__add" (click)="addToCart(item)">
                <svg xmlns="https://cdn-icons-png.flaticon.com/128/4202/4202388.png" viewBox="0 0 20 20" focusable="false" aria-hidden="true">
                  <path
                    fill="currentColor"
                    d="M3 1a1 1 0 000 2h1l.89 4.45A2 2 0 007 9h7a2 2 0 001.98-1.75l.75-4.5A1 1 0 0015.75 2H5.21l-.2-1H3zm4 16a2 2 0 100-4 2 2 0 000 4zm7 0a2 2 0 100-4 2 2 0 000 4z"
                  ></path>
                </svg>
                <span>Adicionar ao carrinho</span>
              </button>
              <button
                type="button"
                class="product-card__details"
                (click)="navigateToCart()"
                [disabled]="cartItems.length === 0"
              >
                Ver carrinho
              </button>
            </div>
          </article>
        </div>
      </article>
    </div>
  </div>
  <button
    type="button"
    class="floating-cart"
    (click)="navigateToCart()"
    [attr.aria-disabled]="cartItems.length === 0"
    aria-label="Ir para o carrinho"
  >
    <span class="floating-cart__icon" aria-hidden="true">
      <svg xmlns="https://cdn-icons-png.flaticon.com/128/4202/4202388.png" viewBox="0 0 20 20" focusable="false">
        <path
          fill="currentColor"
          d="M3 1a1 1 0 000 2h1l.89 4.45A2 2 0 007 9h7a2 2 0 001.98-1.75l.75-4.5A1 1 0 0015.75 2H5.21l-.2-1H3zm4 16a2 2 0 100-4 2 2 0 000 4zm7 0a2 2 0 100-4 2 2 0 000 4z"
        ></path>
      </svg>
      <span class="floating-cart__badge" *ngIf="cartItems.length > 0">
        {{ totalQuantity() }}
      </span>
    </span>
    <span class="floating-cart__text" *ngIf="cartItems.length > 0; else emptyCart">
      <strong>{{ cartTotal() | currency: 'BRL':'symbol-narrow' }}</strong>
      <span>{{ totalQuantity() }} itens</span>
    </span>
  </button>
<ng-template #emptyCart>
  <span class="floating-cart__text">Carrinho vazio</span>
</ng-template>
</section>
